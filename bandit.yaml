# Bandit configuration for ShadowScan
# https://bandit.readthedocs.io

profiles:
  default:
    exclude_dirs:
      - tests
      - docs
      - venv
      - .tox
      - .venv
      - build
      - dist
      - .eggs
      - .git
      - .hg
      - .svn
      - .tox
      - .vscode
      - __pycache__

    checks: 
      # Security checks
      - B101  # assert
      - B102  # exec
      - B103  # setuid
      - B104  # hardcoded_bind_all_interfaces
      - B105  # hardcoded_password_string
      - B106  # hardcoded_password_funcarg
      - B107  # hardcoded_password_default
      - B108  # hardcoded_tmp_directory
      - B110  # try_except_pass
      - B301  # pickle
      - B302  # marshal
      - B303  # md5
      - B304  # ciphers
      - B305  # cipher_modes
      - B306  # mktemp
      - B307  # eval
      - B308  # mark_safe
      - B309  # httpsconnection
      - B310  # urllib
      - B311  # random
      - B312  # telnetlib
      - B313  # XML
      - B314  # xmlrpclib
      - B315  # configparser
      - B316  # tempfile.mktemp
      - B317  # builtin_input
      - B318  # subprocess
      - B319  # xml_bad_celementtree
      - B320  # xml_bad_etree
      - B321  # xml_bad_minidom
      - B322  # xml_bad_pulldom
      - B323  # xml_bad_sax
      - B324  # md5_used
      - B325  # ntp_monlist
      - B404  # import subprocess
      - B408  # hardcoded_sql_expressions
      - B501  # django_sql_injection
      - B502  # django_xss
      - B503  # django_raw_sql
      - B504  # django_extra_used
      - B505  # django_defused_xml
      - B506  # django_orm
      - B507  # django_file_upload
      - B508  # django_user_model
      - B601  # paramiko
      - B602  # subprocess_popen_with_shell_equals_true
      - B603  # subprocess_without_shell_equals_true
      - B604  # any_other_function_with_shell_equals_true
      - B605  # start_process_with_a_shell
      - B606  # start_process_with_no_path_filter
      - B607  # start_process_with_partial_path
      - B608  # hardcoded_sql_expressions
      - B609  # linux_commands_used_to_run_as_other_user
      - B610  # django_extra_used
      - B611  # django_orm
      - B612  # paramiko
      - B613  # aiohttp_http_request
      - B614  # aiohttp_http_request
      - B701  # jinja2_autoescape_false
      - B702  # use_of_mako_templates
      - B703  # django_loader_render
      - B704  # django_loader_render_to_string

  blockchain:
    # Special profile for blockchain security
    checks:
      - B101  # assert
      - B105  # hardcoded_password_string
      - B301  # pickle
      - B303  # md5
      - B304  # ciphers
      - B305  # cipher_modes
      - B310  # urllib
      - B311  # random
      - B324  # md5_used
      - B501  # django_sql_injection
      - B502  # django_xss
      - B503  # django_raw_sql
      - B602  # subprocess_popen_with_shell_equals_true
      - B603  # subprocess_without_shell_equals_true
      - B604  # any_other_function_with_shell_equals_true
      - B605  # start_process_with_a_shell
      - B606  # start_process_with_no_path_filter
      - B607  # start_process_with_partial_path
      - B701  # jinja2_autoescape_false
      - B702  # use_of_mako_templates
      - B703  # django_loader_render
      - B704  # django_loader_render_to_string
      - B999  # Custom blockchain security checks

exclude:
  - tests/*
  - docs/*

skips:
  - B101  # Allow asserts in tests
  - B301  # Allow pickle in certain cases
  - B303  # Allow md5 in certain cases
